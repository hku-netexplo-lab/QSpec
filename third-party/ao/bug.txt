  DEPRECATION: Legacy editable install of torchao==0.9.0+gitc6611be2 from file:///workspace/qspec/ao (setup.py develop) is deprecated. pip 25.1 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools >= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457
    error: subprocess-exited-with-error
    
    × python setup.py develop did not run successfully.
    │ exit code: 1
    ╰─> [1745 lines of output]
        running develop
        /opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/develop.py:41: EasyInstallDeprecationWarning: easy_install command is deprecated.
        !!
        
                ********************************************************************************
                Please avoid running ``setup.py`` and ``easy_install``.
                Instead, use pypa/build, pypa/installer or other
                standards-based tools.
        
                See https://github.com/pypa/setuptools/issues/917 for details.
                ********************************************************************************
        
        !!
          easy_install.initialize_options(self)
        /opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/cmd.py:79: SetuptoolsDeprecationWarning: setup.py install is deprecated.
        !!
        
                ********************************************************************************
                Please avoid running ``setup.py`` directly.
                Instead, use pypa/build, pypa/installer or other
                standards-based tools.
        
                See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
                ********************************************************************************
        
        !!
          self.initialize_options()
        running egg_info
        writing torchao.egg-info/PKG-INFO
        writing dependency_links to torchao.egg-info/dependency_links.txt
        writing requirements to torchao.egg-info/requires.txt
        writing top-level names to torchao.egg-info/top_level.txt
        reading manifest file 'torchao.egg-info/SOURCES.txt'
        adding license file 'LICENSE'
        writing manifest file 'torchao.egg-info/SOURCES.txt'
        running build_ext
        /opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py:416: UserWarning: The detected CUDA version (12.5) has a minor version mismatch with the version that was used to compile PyTorch (12.4). Most likely this shouldn't be a problem.
          warnings.warn(CUDA_MISMATCH_WARN.format(cuda_str_version, torch.version.cuda))
        /opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py:426: UserWarning: There are no g++ version bounds defined for CUDA version 12.5
          warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
        building 'torchao._C' extension
        /opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py:1964: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation.
        If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
          warnings.warn(
        Emitting ninja build file /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/build.ninja...
        Compiling objects...
        Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
        [1/1] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o.d -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/TH -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/THC -I/usr/local/cuda/include -I/opt/conda/envs/QServe/include/python3.10 -c -c /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu -o /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -t=0 -DTORCHAO_USE_CUTLASS -I/workspace/qspec/ao/third_party/cutlass/include -I/workspace/qspec/ao/torchao/csrc/cuda -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -std=c++17
        FAILED: /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o
        /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o.d -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/TH -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/THC -I/usr/local/cuda/include -I/opt/conda/envs/QServe/include/python3.10 -c -c /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu -o /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -t=0 -DTORCHAO_USE_CUTLASS -I/workspace/qspec/ao/third_party/cutlass/include -I/workspace/qspec/ao/torchao/csrc/cuda -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -std=c++17
        /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(560): error: no instance of function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" matches the argument list
                    argument types are: (const at::Tensor, const at::Tensor, const at::Tensor, const at::Tensor, at::Tensor)
                    w4a16_per_channel_linear_kernel_cutlass_sm8x<
                    ^
        /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(42): note #3323-D: substituting explicit template arguments "<ThreadblockShape, WarpShape, InstructionShape, ThreadblockSwizzle, <expression>, cutlass::half_t, cutlass::int4b_t, cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>" for function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" failed
          void w4a16_per_channel_linear_kernel_cutlass_sm8x(
               ^
                  detected during:
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_tensor_op_policy.h(58): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaShape = typename Operator::Shape;
                                      ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaTensorOpPolicy<Operator_, OpDelta_> [with Operator_=cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, OpDelta_=cutlass::MatrixShape<1, 1>]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    [ 2 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(379): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using ElementAMma = typename ArchMmaOperator::ElementA;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(382): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using ElementBMma = typename ArchMmaOperator::ElementB;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(385): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaElementC = typename ArchMmaOperator::ElementC;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(388): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MathOperator = typename ArchMmaOperator::Operator;
                                          ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(391): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using ArchTag = typename ArchMmaOperator::ArchTag;
                                     ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(397): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using InstructionShape = typename ArchMmaOperator::Shape;
                                              ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
               MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                           ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
               MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(424): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<16, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            using FragmentA = typename IteratorA::Fragment;
                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(428): error: name followed by "::" must be a class or namespace name
                Array<ElementAMma, FragmentA::kElements>;
                                   ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(431): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaOperandA = typename ArchMmaOperator::FragmentA;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                            ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                                                        ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(440): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            using FragmentB = typename IteratorB::Fragment;
                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(444): error: name followed by "::" must be a class or namespace name
                Array<ElementBMma, FragmentB::kElements>;
                                   ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(447): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaOperandB = typename ArchMmaOperator::FragmentB;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(452): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
               typename ArchMmaOperator::Shape, typename Policy::OpDelta>;
                        ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(455): error: incomplete type "cutlass::gemm::warp::MmaTensorOpAccumulatorTileIterator<cutlass::MatrixShape<16, 32>, int32_t, cutlass::layout::RowMajor, <error-type>, cutlass::MatrixShape<1, 1>>" is not allowed
            using FragmentC = typename IteratorC::Fragment;
                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(458): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaOperandC = typename ArchMmaOperator::FragmentC;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                           ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                                                             ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                           ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                                                             ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(470): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            ArchMmaOperator mma;
                            ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(117): error: name followed by "::" must be a class or namespace name
                (WarpGemm::kK / Operator::Policy::MmaShape::kK);
                                                  ^
                  detected during:
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 128
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(205): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<16, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            typename Operator::IteratorA warp_tile_iterator_A_;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(208): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            typename Operator::IteratorB warp_tile_iterator_B_;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(92): error: static assertion failed with "kCrosswise should be no large than one shared memory cache line."
            static_assert(
            ^
                  detected during:
                    instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                    instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                    instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                    instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    [ 3 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(101): warning #39-D: division by zero
                ((kTileShapeContiguous / kFactor) > (32 / kTileShapeContiguous))
                                       ^
                  detected during:
                    instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 109
                    instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                    instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                    instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                    instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    [ 4 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(102): warning #39-D: division by zero
                    ? (kTileShapeContiguous / kFactor)
                                            ^
                  detected during:
                    instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 109
                    instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                    instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                    instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                    instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    [ 4 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(109): error: expression must have a constant value
            using TileShape = PitchLinearShape<kTileShapeContiguous, kTileShapeStride>;
                                                                     ^
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(109): note #2689-D: the value of member "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise>::kTileShapeStride [with ElementSize=16, Crosswise=128]" (declared at line 100) cannot be used as a constant
            using TileShape = PitchLinearShape<kTileShapeContiguous, kTileShapeStride>;
                                                                     ^
                  detected during:
                    instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                    instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                    instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                    instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    [ 3 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(578): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(579): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(580): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(584): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(585): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(586): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(596): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              typename WarpMmaTensorOp::Policy::Operator::Shape,
                       ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(760): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(761): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(762): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(766): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(767): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(768): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                                  typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                           ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(778): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              typename WarpMmaTensorOp::Policy::Operator::Shape,
                       ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(119): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
            using AccumulatorTile = typename AccumulatorFragmentIterator::AccumulatorTile;
                                             ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(122): error: a class or namespace qualified name is required
            using ElementAccumulator = typename AccumulatorTile::Element;
                                                ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(122): error: expected a ";"
            using ElementAccumulator = typename AccumulatorTile::Element;
                                                               ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(198): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
            WarpTileIterator warp_tile_iterator_;
                             ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h(63): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
            using AccumulatorTile = typename AccumulatorFragmentIterator::AccumulatorTile;
                                             ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 95 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h(78): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
            using AccumulatorFragment = typename AccumulatorFragmentIterator::Fragment;
                                                 ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 95 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(64): warning #61-D: integer operation result is out of range
                static const int value = Detail<ObjectBytes, AlignBytes * 2>::value;
                                                                        ^
                  detected during:
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=1073741824, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=536870912, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=268435456, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=134217728, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=67108864, IsAligned=<error-constant>]" at line 64
                    [ 34 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(64): warning #61-D: integer operation result is out of range
                static const int value = Detail<ObjectBytes, AlignBytes * 2>::value;
                                                                        ^
                  detected during:
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=-2147483648, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=1073741824, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=536870912, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=268435456, IsAligned=<error-constant>]" at line 64
                    instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=134217728, IsAligned=<error-constant>]" at line 64
                    [ 35 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
                AccessWidth<T, 16>::value>
                ^
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
                AccessWidth<T, 16>::value>
                ^
                  detected during:
                    processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 149
                    processing of template argument list for "cutlass::BlockStriped" based on template arguments <128, <error-type>> at line 91 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 95 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    [ 2 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h(144): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
            using AccumulatorFragment = typename AccumulatorFragmentIterator::Fragment;
                                                 ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h(166): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
            using AccumulatorAccessType = Array<typename WarpTileIterator::Element, OutputTileIterator::kElementsPerAccess>;
                                                         ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                    instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
                AccessWidth<T, 16>::value>
                ^
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
                AccessWidth<T, 16>::value>
                ^
                  detected during:
                    processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 212
                    processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 255 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(94): error: not a class or struct name
          struct alignas(TransferBytes) StripedAccessType : public T
                                                                   ^
                  detected during:
                    instantiation of class "cutlass::StripedAccessType<T, TransferBytes> [with T=<error-type>, TransferBytes=<error-constant>]" at line 212
                    processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 255 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(212): error: class "cutlass::StripedAccessType<<error-type>, <error-constant>>" has no member "Element"
            typename ElementT = typename StripedAccessType<ArrayT>::Element>
                                                                    ^
                  detected during:
                    processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 255 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h(121): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
            using ElementAccumulator = typename WarpTileIterator::Element;
                                                ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll> [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 73 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                    instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h(129): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
            using AccumulatorFragment = typename AccumulatorFragmentIterator::Fragment;
                                                 ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll> [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 73 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                    instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h(136): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
              typename WarpTileIterator::Element, kElementsPerAccess>;
                       ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll> [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 73 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                    instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
                AccessWidth<T, 16>::value>
                ^
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
                AccessWidth<T, 16>::value>
                ^
                  detected during:
                    processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 212
                    processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 113 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                    instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(212): error: class "cutlass::StripedAccessType<<error-type>, <error-constant>>" has no member "Element"
            typename ElementT = typename StripedAccessType<ArrayT>::Element>
                                                                    ^
                  detected during:
                    processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 113 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                    instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
                AccessWidth<T, 16>::value>
                ^
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
                AccessWidth<T, 16>::value>
                ^
                  detected during:
                    processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 212
                    processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 121 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                    instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(212): error: class "cutlass::StripedAccessType<<error-type>, <error-constant>>" has no member "Element"
            typename ElementT = typename StripedAccessType<ArrayT>::Element>
                                                                    ^
                  detected during:
                    processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 121 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                    instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(144): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
              using Element = typename WarpTileIterator::Element;
                                       ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    [ 4 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(147): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
              using TensorRef = typename WarpTileIterator::TensorRef;
                                         ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    [ 4 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(150): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
              using Layout = typename WarpTileIterator::Layout;
                                      ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    [ 4 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(154): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
                WarpCount::kM * WarpTileIterator::Shape::kRow * WarpCount::kK,
                                ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    [ 4 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(155): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
                WarpCount::kN * WarpTileIterator::Shape::kColumn
                                ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    [ 4 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/aligned_buffer.h(84): error: incomplete type "cutlass::Array<<error-type>, <error-constant>, <error-constant>>" is not allowed
            using reference = typename Array::reference;
                                       ^
                  detected during:
                    instantiation of class "cutlass::AlignedBuffer<T, N, Align> [with T=<error-type>, N=<error-constant>, Align=16]" at line 168 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    [ 5 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/aligned_buffer.h(85): error: incomplete type "cutlass::Array<<error-type>, <error-constant>, <error-constant>>" is not allowed
            using const_reference = typename Array::const_reference;
                                             ^
                  detected during:
                    instantiation of class "cutlass::AlignedBuffer<T, N, Align> [with T=<error-type>, N=<error-constant>, Align=16]" at line 168 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                    instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    [ 5 instantiation contexts not shown ]
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h(83): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
            static int const kAccumulatorFragments = AccumulatorFragmentIterator::Policy::kIterations;
                                                     ^
                  detected during:
                    instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 246 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                    instantiation of "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::Params::Params(const cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::Arguments &, int, int) [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 258 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_params(const cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 333 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "dim3 cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::get_grid_shape(const cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 275 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::can_implement(const cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 659 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_adapter.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, std::enable_if_t<<expression>, void>>::can_implement(const cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, std::enable_if_t<<expression>, void>>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 470 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/device_kernel.h(98): warning #1290-D: a class type that is not trivially copyable passed through ellipsis
            Operator::invoke(params, *shared_storage);
                                     ^
                  detected during:
                    instantiation of "void cutlass::Kernel2<Operator>(Operator::Params) [with Operator=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 461 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::run(cudaStream_t, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 700 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_adapter.h
                    instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, std::enable_if_t<<expression>, void>>::run(cudaStream_t, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 484 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(579): error: no instance of function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" matches the argument list
                    argument types are: (const at::Tensor, const at::Tensor, const at::Tensor, const at::Tensor, at::Tensor)
                    w4a16_per_channel_linear_kernel_cutlass_sm8x<
                    ^
        /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(42): note #3323-D: substituting explicit template arguments "<ThreadblockShape, WarpShape, InstructionShape, ThreadblockSwizzle, <expression>, cutlass::half_t, cutlass::int4b_t, cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>" for function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" failed
          void w4a16_per_channel_linear_kernel_cutlass_sm8x(
               ^
                  detected during:
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(379): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using ElementAMma = typename ArchMmaOperator::ElementA;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(382): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using ElementBMma = typename ArchMmaOperator::ElementB;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(385): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaElementC = typename ArchMmaOperator::ElementC;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(388): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MathOperator = typename ArchMmaOperator::Operator;
                                          ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(391): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using ArchTag = typename ArchMmaOperator::ArchTag;
                                     ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(397): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using InstructionShape = typename ArchMmaOperator::Shape;
                                              ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
               MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                           ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
               MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(424): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<32, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            using FragmentA = typename IteratorA::Fragment;
                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(428): error: name followed by "::" must be a class or namespace name
                Array<ElementAMma, FragmentA::kElements>;
                                   ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(431): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaOperandA = typename ArchMmaOperator::FragmentA;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                            ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                                                        ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(440): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            using FragmentB = typename IteratorB::Fragment;
                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(444): error: name followed by "::" must be a class or namespace name
                Array<ElementBMma, FragmentB::kElements>;
                                   ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(447): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaOperandB = typename ArchMmaOperator::FragmentB;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(452): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
               typename ArchMmaOperator::Shape, typename Policy::OpDelta>;
                        ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(455): error: incomplete type "cutlass::gemm::warp::MmaTensorOpAccumulatorTileIterator<cutlass::MatrixShape<32, 32>, int32_t, cutlass::layout::RowMajor, <error-type>, cutlass::MatrixShape<1, 1>>" is not allowed
            using FragmentC = typename IteratorC::Fragment;
                                       ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(458): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            using MmaOperandC = typename ArchMmaOperator::FragmentC;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                           ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                                                             ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                           ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
              (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                                                             ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(470): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            ArchMmaOperator mma;
                            ^
                  detected during:
                    instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(117): error: name followed by "::" must be a class or namespace name
                (WarpGemm::kK / Operator::Policy::MmaShape::kK);
                                                  ^
                  detected during:
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 128
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(205): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<32, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            typename Operator::IteratorA warp_tile_iterator_A_;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(208): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
            typename Operator::IteratorB warp_tile_iterator_B_;
                                         ^
                  detected during:
                    instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                    instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                    instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                    instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
        
        Error limit reached.
        100 errors detected in the compilation of "/workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu".
        Compilation terminated.
        ninja: build stopped: subcommand failed.
        Traceback (most recent call last):
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2104, in _run_ninja_build
            subprocess.run(
          File "/opt/conda/envs/QServe/lib/python3.10/subprocess.py", line 526, in run
            raise CalledProcessError(retcode, process.args,
        subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1.
        
        The above exception was the direct cause of the following exception:
        
        Traceback (most recent call last):
          File "<string>", line 2, in <module>
          File "<pip-setuptools-caller>", line 34, in <module>
          File "/workspace/qspec/ao/setup.py", line 305, in <module>
            setup(
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/__init__.py", line 117, in setup
            return distutils.core.setup(**attrs)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/core.py", line 186, in setup
            return run_commands(dist)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/core.py", line 202, in run_commands
            dist.run_commands()
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/dist.py", line 983, in run_commands
            self.run_command(cmd)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/dist.py", line 999, in run_command
            super().run_command(command)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/dist.py", line 1002, in run_command
            cmd_obj.run()
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/develop.py", line 35, in run
            self.install_for_development()
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/develop.py", line 112, in install_for_development
            self.run_command('build_ext')
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/cmd.py", line 339, in run_command
            self.distribution.run_command(command)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/dist.py", line 999, in run_command
            super().run_command(command)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/dist.py", line 1002, in run_command
            cmd_obj.run()
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 99, in run
            _build_ext.run(self)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 365, in run
            self.build_extensions()
          File "/workspace/qspec/ao/setup.py", line 161, in build_extensions
            super().build_extensions()
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 868, in build_extensions
            build_ext.build_extensions(self)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 481, in build_extensions
            self._build_extensions_serial()
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 507, in _build_extensions_serial
            self.build_extension(ext)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 264, in build_extension
            _build_ext.build_extension(self, ext)
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 562, in build_extension
            objects = self.compiler.compile(
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 681, in unix_wrap_ninja_compile
            _write_ninja_file_and_compile_objects(
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1784, in _write_ninja_file_and_compile_objects
            _run_ninja_build(
          File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2120, in _run_ninja_build
            raise RuntimeError(message) from e
        RuntimeError: Error compiling objects for extension
        [end of output]
    
    note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

× python setup.py develop did not run successfully.
│ exit code: 1
╰─> [1745 lines of output]
    running develop
    /opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/develop.py:41: EasyInstallDeprecationWarning: easy_install command is deprecated.
    !!
    
            ********************************************************************************
            Please avoid running ``setup.py`` and ``easy_install``.
            Instead, use pypa/build, pypa/installer or other
            standards-based tools.
    
            See https://github.com/pypa/setuptools/issues/917 for details.
            ********************************************************************************
    
    !!
      easy_install.initialize_options(self)
    /opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/cmd.py:79: SetuptoolsDeprecationWarning: setup.py install is deprecated.
    !!
    
            ********************************************************************************
            Please avoid running ``setup.py`` directly.
            Instead, use pypa/build, pypa/installer or other
            standards-based tools.
    
            See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
            ********************************************************************************
    
    !!
      self.initialize_options()
    running egg_info
    writing torchao.egg-info/PKG-INFO
    writing dependency_links to torchao.egg-info/dependency_links.txt
    writing requirements to torchao.egg-info/requires.txt
    writing top-level names to torchao.egg-info/top_level.txt
    reading manifest file 'torchao.egg-info/SOURCES.txt'
    adding license file 'LICENSE'
    writing manifest file 'torchao.egg-info/SOURCES.txt'
    running build_ext
    /opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py:416: UserWarning: The detected CUDA version (12.5) has a minor version mismatch with the version that was used to compile PyTorch (12.4). Most likely this shouldn't be a problem.
      warnings.warn(CUDA_MISMATCH_WARN.format(cuda_str_version, torch.version.cuda))
    /opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py:426: UserWarning: There are no g++ version bounds defined for CUDA version 12.5
      warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
    building 'torchao._C' extension
    /opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py:1964: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation.
    If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
      warnings.warn(
    Emitting ninja build file /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/build.ninja...
    Compiling objects...
    Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
    [1/1] /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o.d -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/TH -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/THC -I/usr/local/cuda/include -I/opt/conda/envs/QServe/include/python3.10 -c -c /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu -o /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -t=0 -DTORCHAO_USE_CUTLASS -I/workspace/qspec/ao/third_party/cutlass/include -I/workspace/qspec/ao/torchao/csrc/cuda -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -std=c++17
    FAILED: /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o
    /usr/local/cuda/bin/nvcc --generate-dependencies-with-compile --dependency-output /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o.d -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/TH -I/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/include/THC -I/usr/local/cuda/include -I/opt/conda/envs/QServe/include/python3.10 -c -c /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu -o /workspace/qspec/ao/build/temp.linux-x86_64-cpython-310/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -t=0 -DTORCHAO_USE_CUTLASS -I/workspace/qspec/ao/third_party/cutlass/include -I/workspace/qspec/ao/torchao/csrc/cuda -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=_C -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 -std=c++17
    /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(560): error: no instance of function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" matches the argument list
                argument types are: (const at::Tensor, const at::Tensor, const at::Tensor, const at::Tensor, at::Tensor)
                w4a16_per_channel_linear_kernel_cutlass_sm8x<
                ^
    /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(42): note #3323-D: substituting explicit template arguments "<ThreadblockShape, WarpShape, InstructionShape, ThreadblockSwizzle, <expression>, cutlass::half_t, cutlass::int4b_t, cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>" for function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" failed
      void w4a16_per_channel_linear_kernel_cutlass_sm8x(
           ^
              detected during:
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_tensor_op_policy.h(58): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaShape = typename Operator::Shape;
                                  ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaTensorOpPolicy<Operator_, OpDelta_> [with Operator_=cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, OpDelta_=cutlass::MatrixShape<1, 1>]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                [ 2 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(379): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using ElementAMma = typename ArchMmaOperator::ElementA;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(382): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using ElementBMma = typename ArchMmaOperator::ElementB;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(385): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaElementC = typename ArchMmaOperator::ElementC;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(388): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MathOperator = typename ArchMmaOperator::Operator;
                                      ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(391): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using ArchTag = typename ArchMmaOperator::ArchTag;
                                 ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(397): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using InstructionShape = typename ArchMmaOperator::Shape;
                                          ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
           MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                       ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
           MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(424): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<16, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        using FragmentA = typename IteratorA::Fragment;
                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(428): error: name followed by "::" must be a class or namespace name
            Array<ElementAMma, FragmentA::kElements>;
                               ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(431): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaOperandA = typename ArchMmaOperator::FragmentA;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                        ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                                                    ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(440): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        using FragmentB = typename IteratorB::Fragment;
                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(444): error: name followed by "::" must be a class or namespace name
            Array<ElementBMma, FragmentB::kElements>;
                               ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(447): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaOperandB = typename ArchMmaOperator::FragmentB;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(452): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
           typename ArchMmaOperator::Shape, typename Policy::OpDelta>;
                    ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(455): error: incomplete type "cutlass::gemm::warp::MmaTensorOpAccumulatorTileIterator<cutlass::MatrixShape<16, 32>, int32_t, cutlass::layout::RowMajor, <error-type>, cutlass::MatrixShape<1, 1>>" is not allowed
        using FragmentC = typename IteratorC::Fragment;
                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(458): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaOperandC = typename ArchMmaOperator::FragmentC;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                       ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                                                         ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                       ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                                                         ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(470): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        ArchMmaOperator mma;
                        ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(117): error: name followed by "::" must be a class or namespace name
            (WarpGemm::kK / Operator::Policy::MmaShape::kK);
                                              ^
              detected during:
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 128
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(205): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<16, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        typename Operator::IteratorA warp_tile_iterator_A_;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(208): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        typename Operator::IteratorB warp_tile_iterator_B_;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(92): error: static assertion failed with "kCrosswise should be no large than one shared memory cache line."
        static_assert(
        ^
              detected during:
                instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                [ 3 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(101): warning #39-D: division by zero
            ((kTileShapeContiguous / kFactor) > (32 / kTileShapeContiguous))
                                   ^
              detected during:
                instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 109
                instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                [ 4 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(102): warning #39-D: division by zero
                ? (kTileShapeContiguous / kFactor)
                                        ^
              detected during:
                instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 109
                instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                [ 4 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(109): error: expression must have a constant value
        using TileShape = PitchLinearShape<kTileShapeContiguous, kTileShapeStride>;
                                                                 ^
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/layout/tensor_op_multiplicand_sm75.h(109): note #2689-D: the value of member "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise>::kTileShapeStride [with ElementSize=16, Crosswise=128]" (declared at line 100) cannot be used as a constant
        using TileShape = PitchLinearShape<kTileShapeContiguous, kTileShapeStride>;
                                                                 ^
              detected during:
                instantiation of class "cutlass::layout::TensorOpMultiplicand<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 682
                instantiation of class "cutlass::layout::TensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 885
                instantiation of class "cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<ElementSize, Crosswise> [with ElementSize=16, Crosswise=128]" at line 747 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/transform/threadblock/regular_tile_access_iterator_tensor_op.h
                instantiation of class "cutlass::transform::threadblock::RegularTileAccessIterator<Shape_, Element_, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<cutlass::sizeof_bits<Element_>::value, Crosswise>, AdvanceRank, ThreadMap_, Alignment> [with Shape_=cutlass::MatrixShape<16, 128>, Element_=cutlass::half_t, AdvanceRank=0, ThreadMap_=cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, Alignment=16, Crosswise=128]" at line 197 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=6, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                [ 3 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(578): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(579): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(580): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(584): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(585): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(586): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(596): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          typename WarpMmaTensorOp::Policy::Operator::Shape,
                   ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOp<Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess, ScatterD, PermuteDLayout, StrideSupport, Rank> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, StrideSupport=cutlass::conv::StrideSupport::kUnity, Rank=4]" at line 376 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(760): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(761): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(762): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(766): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::Shape,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(767): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::ElementC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(768): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
                                              typename WarpMmaTensorOp::Policy::Operator::FragmentC,
                                                       ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/default_epilogue_tensor_op.h(778): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          typename WarpMmaTensorOp::Policy::Operator::Shape,
                   ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::DefaultEpilogueTensorOpAffineRankN<Rank, Shape_, WarpMmaTensorOp_, PartitionsK, OutputOp_, ElementsPerAccess> [with Rank=2, Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaTensorOp_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ElementsPerAccess=8]" at line 381 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(119): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
        using AccumulatorTile = typename AccumulatorFragmentIterator::AccumulatorTile;
                                         ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(122): error: a class or namespace qualified name is required
        using ElementAccumulator = typename AccumulatorTile::Element;
                                            ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(122): error: expected a ";"
        using ElementAccumulator = typename AccumulatorTile::Element;
                                                           ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(198): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
        WarpTileIterator warp_tile_iterator_;
                         ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 87 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h(63): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
        using AccumulatorTile = typename AccumulatorFragmentIterator::AccumulatorTile;
                                         ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 95 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h(78): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
        using AccumulatorFragment = typename AccumulatorFragmentIterator::Fragment;
                                             ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 95 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(64): warning #61-D: integer operation result is out of range
            static const int value = Detail<ObjectBytes, AlignBytes * 2>::value;
                                                                    ^
              detected during:
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=1073741824, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=536870912, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=268435456, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=134217728, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=67108864, IsAligned=<error-constant>]" at line 64
                [ 34 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(64): warning #61-D: integer operation result is out of range
            static const int value = Detail<ObjectBytes, AlignBytes * 2>::value;
                                                                    ^
              detected during:
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=-2147483648, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=1073741824, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=536870912, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=268435456, IsAligned=<error-constant>]" at line 64
                instantiation of class "cutlass::AccessWidth<T, Limit>::Detail<ObjectBytes, AlignBytes, IsAligned> [with T=<error-type>, Limit=16, ObjectBytes=<error-constant>, AlignBytes=134217728, IsAligned=<error-constant>]" at line 64
                [ 35 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
            AccessWidth<T, 16>::value>
            ^
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
            AccessWidth<T, 16>::value>
            ^
              detected during:
                processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 149
                processing of template argument list for "cutlass::BlockStriped" based on template arguments <128, <error-type>> at line 91 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 95 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                [ 2 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h(144): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
        using AccumulatorFragment = typename AccumulatorFragmentIterator::Fragment;
                                             ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue.h(166): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
        using AccumulatorAccessType = Array<typename WarpTileIterator::Element, OutputTileIterator::kElementsPerAccess>;
                                                     ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::Epilogue<Shape_, WarpMmaOperator_, PartitionsK, OutputTileIterator_, AccumulatorFragmentIterator_, WarpTileIterator_, SharedLoadIterator_, OutputOp_, Padding_, FragmentsPerPartition, IterationsUnroll> [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpMmaOperator_=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, PartitionsK=1, OutputTileIterator_=cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, SharedLoadIterator_=cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, OutputOp_=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerPartition=1, IterationsUnroll=1]" at line 63 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm.h
                instantiation of class "cutlass::gemm::kernel::Gemm<Mma_, Epilogue_, ThreadblockSwizzle_, SplitKSerial> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, SplitKSerial=true]" at line 256 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
            AccessWidth<T, 16>::value>
            ^
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
            AccessWidth<T, 16>::value>
            ^
              detected during:
                processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 212
                processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 255 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(94): error: not a class or struct name
      struct alignas(TransferBytes) StripedAccessType : public T
                                                               ^
              detected during:
                instantiation of class "cutlass::StripedAccessType<T, TransferBytes> [with T=<error-type>, TransferBytes=<error-constant>]" at line 212
                processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 255 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(212): error: class "cutlass::StripedAccessType<<error-type>, <error-constant>>" has no member "Element"
        typename ElementT = typename StripedAccessType<ArrayT>::Element>
                                                                ^
              detected during:
                processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 255 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 124 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h(121): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
        using ElementAccumulator = typename WarpTileIterator::Element;
                                            ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll> [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 73 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h(129): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
        using AccumulatorFragment = typename AccumulatorFragmentIterator::Fragment;
                                             ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll> [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 73 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h(136): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
          typename WarpTileIterator::Element, kElementsPerAccess>;
                   ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll> [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 73 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
            AccessWidth<T, 16>::value>
            ^
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
            AccessWidth<T, 16>::value>
            ^
              detected during:
                processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 212
                processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 113 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(212): error: class "cutlass::StripedAccessType<<error-type>, <error-constant>>" has no member "Element"
        typename ElementT = typename StripedAccessType<ArrayT>::Element>
                                                                ^
              detected during:
                processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 113 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): error: expression must have a constant value
            AccessWidth<T, 16>::value>
            ^
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(93): note #2689-D: the value of member "cutlass::AccessWidth<T, Limit>::value [with T=<error-type>, Limit=16]" (declared at line 77) cannot be used as a constant
            AccessWidth<T, 16>::value>
            ^
              detected during:
                processing of template argument list for "cutlass::StripedAccessType" based on template argument <<error-type>> at line 212
                processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 121 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/block_striped.h(212): error: class "cutlass::StripedAccessType<<error-type>, <error-constant>>" has no member "Element"
        typename ElementT = typename StripedAccessType<ArrayT>::Element>
                                                                ^
              detected during:
                processing of template argument list for "cutlass::BlockStripedReduce" based on template arguments <128, <error-type>> at line 110 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 121 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of class "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_> [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 141 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages>::SelectBase<SwizzleT, SwizzleT::StreamkFeature> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=6, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1, SwizzleT=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 15 of /workspace/qspec/ao/torchao/csrc/cuda/cutlass_extensions/common.h
                instantiation of class "torchao::enable_2x_kernel_for_sm80_or_later<Kernel> [with Kernel=cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>]" at line 445 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(144): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
          using Element = typename WarpTileIterator::Element;
                                   ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                [ 4 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(147): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
          using TensorRef = typename WarpTileIterator::TensorRef;
                                     ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                [ 4 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(150): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
          using Layout = typename WarpTileIterator::Layout;
                                  ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                [ 4 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(154): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
            WarpCount::kM * WarpTileIterator::Shape::kRow * WarpCount::kK,
                            ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                [ 4 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h(155): error: incomplete type "cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>" is not allowed
            WarpCount::kN * WarpTileIterator::Shape::kColumn
                            ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_device_props() [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 242 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                [ 4 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/aligned_buffer.h(84): error: incomplete type "cutlass::Array<<error-type>, <error-constant>, <error-constant>>" is not allowed
        using reference = typename Array::reference;
                                   ^
              detected during:
                instantiation of class "cutlass::AlignedBuffer<T, N, Align> [with T=<error-type>, N=<error-constant>, Align=16]" at line 168 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                [ 5 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/aligned_buffer.h(85): error: incomplete type "cutlass::Array<<error-type>, <error-constant>, <error-constant>>" is not allowed
        using const_reference = typename Array::const_reference;
                                         ^
              detected during:
                instantiation of class "cutlass::AlignedBuffer<T, N, Align> [with T=<error-type>, N=<error-constant>, Align=16]" at line 168 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBase<Shape_, WarpShape_, PartitionsK, AccumulatorFragmentIterator_, WarpTileIterator_, Padding_, FragmentsPerIteration>::SharedStorage [with Shape_=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape_=cutlass::gemm::GemmShape<16, 32, 128>, PartitionsK=1, AccumulatorFragmentIterator_=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, WarpTileIterator_=cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, Padding_=cutlass::MatrixShape<0, 8>, FragmentsPerIteration=1]" at line 147 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_with_visitor_callbacks.h
                instantiation of class "cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<DefaultEpilogue, FusionCallbacks_, Stages, IterationsUnroll>::SharedStorage [with DefaultEpilogue=cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, FusionCallbacks_=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, Stages=1, IterationsUnroll=1]" at line 513 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_streamk.h
                instantiation of union "cutlass::gemm::kernel::GemmUniversalStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::SharedStorage [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 109 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of class "cutlass::gemm::device::GemmUniversalBase<GemmKernel_> [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 158 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                [ 5 instantiation contexts not shown ]
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/epilogue/threadblock/epilogue_base_streamk.h(83): error: incomplete type "cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>" is not allowed
        static int const kAccumulatorFragments = AccumulatorFragmentIterator::Policy::kIterations;
                                                 ^
              detected during:
                instantiation of class "cutlass::epilogue::threadblock::EpilogueBaseStreamK<Shape, PartitionsK, WarpMmaOperator, AccumulatorFragmentIterator> [with Shape=cutlass::gemm::GemmShape<16, 128, 128>, PartitionsK=1, WarpMmaOperator=cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, AccumulatorFragmentIterator=cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>]" at line 246 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/gemm_universal_with_visitor_streamk.h
                instantiation of "cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::Params::Params(const cutlass::gemm::kernel::GemmWithEpilogueVisitorStreamk<Mma_, Epilogue_, ThreadblockSwizzle_>::Arguments &, int, int) [with Mma_=cutlass::gemm::threadblock::MmaMultistage<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<16, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 16>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, cutlass::arch::CacheOperation::Global, cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, cutlass::arch::CacheOperation::Global, int32_t, cutlass::layout::RowMajor, cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, 6, cutlass::gemm::SharedMemoryClearOption::kNone, __nv_bool>, Epilogue_=cutlass::epilogue::threadblock::EpilogueWithVisitorCallbacks<cutlass::epilogue::threadblock::Epilogue<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, 1, cutlass::epilogue::threadblock::PredicatedTileIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>, cutlass::half_t, false, cutlass::layout::NoPermute, false>, cutlass::epilogue::warp::FragmentIteratorComplexTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, <error-type>, <error-type>, cutlass::layout::RowMajor>, cutlass::epilogue::warp::TileIteratorTensorOp<cutlass::gemm::GemmShape<16, 32, 128>, <error-type>, int32_t, cutlass::layout::RowMajor>, cutlass::epilogue::threadblock::SharedLoadIterator<cutlass::epilogue::threadblock::OutputTileOptimalThreadMap<cutlass::epilogue::threadblock::OutputTileShape<128, 8, 1, 1, 1>, cutlass::epilogue::threadblock::OutputTileShape<1, 2, 1, 1, 2>, 128, 8, 16>::CompactedThreadMap, int32_t, 32>, cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, cutlass::MatrixShape<0, 8>, 1, 1>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, 1, 1>, ThreadblockSwizzle_=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK]" at line 258 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::init_params(const cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 333 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "dim3 cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::get_grid_shape(const cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 275 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::can_implement(const cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 659 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_adapter.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, std::enable_if_t<<expression>, void>>::can_implement(const cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, std::enable_if_t<<expression>, void>>::Arguments &, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 470 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/device_kernel.h(98): warning #1290-D: a class type that is not trivially copyable passed through ellipsis
        Operator::invoke(params, *shared_storage);
                                 ^
              detected during:
                instantiation of "void cutlass::Kernel2<Operator>(Operator::Params) [with Operator=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 461 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_base.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalBase<GemmKernel_>::run(cudaStream_t, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 700 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/device/gemm_universal_adapter.h
                instantiation of "cutlass::Status cutlass::gemm::device::GemmUniversalAdapter<GemmKernel_, std::enable_if_t<<expression>, void>>::run(cudaStream_t, cutlass::CudaHostAdapter *) [with GemmKernel_=torchao::enable_2x_kernel_for_sm80_or_later<cutlass::gemm::kernel::DefaultGemmWithVisitor<cutlass::half_t, cutlass::layout::RowMajor, cutlass::ComplexTransform::kNone, 8, cutlass::int4b_t, cutlass::layout::ColumnMajor, cutlass::ComplexTransform::kNone, 32, cutlass::half_t, cutlass::layout::RowMajor, 8, int32_t, float, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::gemm::GemmShape<16, 8, 32>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<16, 128, 128>, cutlass::gemm::GemmShape<16, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, 6, cutlass::arch::OpMultiplyAddMixedInputUpcast, 1>::SelectBase<cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, void>>]" at line 484 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<16, 128, 128>, WarpShape=cutlass::gemm::GemmShape<16, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=6, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 570 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(579): error: no instance of function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" matches the argument list
                argument types are: (const at::Tensor, const at::Tensor, const at::Tensor, const at::Tensor, at::Tensor)
                w4a16_per_channel_linear_kernel_cutlass_sm8x<
                ^
    /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh(42): note #3323-D: substituting explicit template arguments "<ThreadblockShape, WarpShape, InstructionShape, ThreadblockSwizzle, <expression>, cutlass::half_t, cutlass::int4b_t, cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>" for function template "torchao::w4a16_per_channel_linear_kernel_cutlass_sm8x" failed
      void w4a16_per_channel_linear_kernel_cutlass_sm8x(
           ^
              detected during:
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(379): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using ElementAMma = typename ArchMmaOperator::ElementA;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(382): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using ElementBMma = typename ArchMmaOperator::ElementB;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(385): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaElementC = typename ArchMmaOperator::ElementC;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(388): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MathOperator = typename ArchMmaOperator::Operator;
                                      ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(391): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using ArchTag = typename ArchMmaOperator::ArchTag;
                                 ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(397): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using InstructionShape = typename ArchMmaOperator::Shape;
                                          ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
           MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                       ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(420): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
           MatrixShape<ArchMmaOperator::Shape::kM, ArchMmaOperator::Shape::kK>,
                                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(424): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<32, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        using FragmentA = typename IteratorA::Fragment;
                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(428): error: name followed by "::" must be a class or namespace name
            Array<ElementAMma, FragmentA::kElements>;
                               ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(431): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaOperandA = typename ArchMmaOperator::FragmentA;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                        ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(436): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
            MatrixShape<ArchMmaOperator::Shape::kK, ArchMmaOperator::Shape::kN>,
                                                    ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(440): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        using FragmentB = typename IteratorB::Fragment;
                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(444): error: name followed by "::" must be a class or namespace name
            Array<ElementBMma, FragmentB::kElements>;
                               ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(447): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaOperandB = typename ArchMmaOperator::FragmentB;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(452): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
           typename ArchMmaOperator::Shape, typename Policy::OpDelta>;
                    ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(455): error: incomplete type "cutlass::gemm::warp::MmaTensorOpAccumulatorTileIterator<cutlass::MatrixShape<32, 32>, int32_t, cutlass::layout::RowMajor, <error-type>, cutlass::MatrixShape<1, 1>>" is not allowed
        using FragmentC = typename IteratorC::Fragment;
                                   ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(458): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        using MmaOperandC = typename ArchMmaOperator::FragmentC;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                       ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(462): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kM + ArchMmaOperator::Shape::kM - 1) / ArchMmaOperator::Shape::kM,
                                                         ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                       ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(463): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
          (Shape::kN + ArchMmaOperator::Shape::kN - 1) / ArchMmaOperator::Shape::kN
                                                         ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/warp/mma_mixed_input_tensor_op.h(470): error: incomplete type "cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>" is not allowed
        ArchMmaOperator mma;
                        ^
              detected during:
                instantiation of class "cutlass::gemm::warp::MmaMixedInputTensorOp<Shape_, ElementA_, LayoutA_, ElementB_, LayoutB_, ElementC_, LayoutC_, Policy_, PartitionsK_, AccumulatorsInRowMajor, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 32, 128>, ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, PartitionsK_=1, AccumulatorsInRowMajor=false, Enable=__nv_bool]" at line 108 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(117): error: name followed by "::" must be a class or namespace name
            (WarpGemm::kK / Operator::Policy::MmaShape::kK);
                                              ^
              detected during:
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 128
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(205): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<32, 128>, cutlass::gemm::Operand::kA, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        typename Operator::IteratorA warp_tile_iterator_A_;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_base.h(208): error: incomplete type "cutlass::gemm::warp::MmaTensorOpMultiplicandTileIterator<cutlass::MatrixShape<128, 32>, cutlass::gemm::Operand::kB, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, cutlass::MatrixShape<<error-constant>, <error-constant>>, 1, 32, 1>" is not allowed
        typename Operator::IteratorB warp_tile_iterator_B_;
                                     ^
              detected during:
                instantiation of class "cutlass::gemm::threadblock::MmaBase<Shape_, Policy_, Stages, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, Enable=__nv_bool]" at line 92 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/threadblock/mma_multistage.h
                instantiation of class "cutlass::gemm::threadblock::MmaMultistage<Shape_, IteratorA_, SmemIteratorA_, CacheOpA, IteratorB_, SmemIteratorB_, CacheOpB, ElementC_, LayoutC_, Policy_, Stages, SharedMemoryClear, Enable> [with Shape_=cutlass::gemm::GemmShape<32, 128, 128>, IteratorA_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajor, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, cutlass::Array<cutlass::half_t, 8, false>, false, cutlass::layout::NoPermute>, SmemIteratorA_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 32>, 128, cutlass::PitchLinearShape<16, 2>, 8>, 16>, CacheOpA=cutlass::arch::CacheOperation::Global, IteratorB_=cutlass::transform::threadblock::PredicatedTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajor, 0, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, cutlass::Array<cutlass::int4b_t, 32, false>, false, cutlass::layout::NoPermute>, SmemIteratorB_=cutlass::transform::threadblock::RegularTileAccessIterator<cutlass::MatrixShape<128, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, 1, cutlass::transform::PitchLinearWarpRakedThreadMap<cutlass::PitchLinearShape<128, 128>, 128, cutlass::PitchLinearShape<4, 8>, 32>, 16>, CacheOpB=cutlass::arch::CacheOperation::Global, ElementC_=int32_t, LayoutC_=cutlass::layout::RowMajor, Policy_=cutlass::gemm::threadblock::MmaPolicy<cutlass::gemm::warp::MmaMixedInputTensorOp<cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, cutlass::layout::RowMajorTensorOpMultiplicandCrosswise<16, 128>, cutlass::int4b_t, cutlass::layout::ColumnMajorTensorOpMultiplicandCrosswise<4, 128>, int32_t, cutlass::layout::RowMajor, cutlass::gemm::warp::MmaTensorOpPolicy<cutlass::arch::Mma<cutlass::gemm::GemmShape<16, 8, 32>, 32, cutlass::half_t, cutlass::layout::RowMajor, cutlass::half_t, cutlass::layout::ColumnMajor, int32_t, cutlass::layout::RowMajor, cutlass::arch::OpMultiplyAddSaturate>, cutlass::MatrixShape<1, 1>>, 1, false, __nv_bool>, cutlass::MatrixShape<0, 0>, cutlass::MatrixShape<0, 0>, 1>, Stages=5, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, Enable=__nv_bool]" at line 375 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemm<ElementA, LayoutA, kAlignmentA, ElementB, LayoutB, kAlignmentB, ElementC, LayoutC, ElementAccumulator, cutlass::arch::OpClassTensorOp, cutlass::arch::Sm80, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, SplitKSerial, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, void> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, SplitKSerial=true, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 241 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmUniversal<ElementA, LayoutA, cutlass::ComplexTransform::kNone, kAlignmentA, ElementB, LayoutB, cutlass::ComplexTransform::kNone, kAlignmentB, ElementC, LayoutC, ElementAccumulator, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, EpilogueOutputOp, ThreadblockSwizzle, Stages, Operator, SharedMemoryClear, GatherA, GatherB, ScatterD, PermuteDLayout, PermuteALayout, PermuteBLayout, std::enable_if<<expression>, void>::type> [with ElementA=cutlass::half_t, LayoutA=cutlass::layout::RowMajor, kAlignmentA=8, ElementB=cutlass::int4b_t, LayoutB=cutlass::layout::ColumnMajor, kAlignmentB=32, ElementC=cutlass::half_t, LayoutC=cutlass::layout::RowMajor, ElementAccumulator=int32_t, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, EpilogueOutputOp=cutlass::epilogue::thread::LinearCombination<cutlass::half_t, 8, int32_t, float, cutlass::epilogue::thread::ScaleType::Default, cutlass::FloatRoundStyle::round_to_nearest, cutlass::half_t>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, SharedMemoryClear=cutlass::gemm::SharedMemoryClearOption::kNone, GatherA=false, GatherB=false, ScatterD=false, PermuteDLayout=cutlass::layout::NoPermute, PermuteALayout=cutlass::layout::NoPermute, PermuteBLayout=cutlass::layout::NoPermute]" at line 120 of /workspace/qspec/ao/third_party/cutlass/include/cutlass/gemm/kernel/default_gemm_universal_with_visitor.h
                instantiation of class "cutlass::gemm::kernel::DefaultGemmWithVisitor<ElementA_, LayoutA_, TransformA, kAlignmentA, ElementB_, LayoutB_, TransformB, kAlignmentB, ElementC_, LayoutC_, kAlignmentC, ElementAccumulator, ElementEpilogue, OperatorClass, ArchTag, ThreadblockShape, WarpShape, InstructionShape, FusionCallbacks, ThreadblockSwizzle, Stages, Operator, EpilogueStages> [with ElementA_=cutlass::half_t, LayoutA_=cutlass::layout::RowMajor, TransformA=cutlass::ComplexTransform::kNone, kAlignmentA=8, ElementB_=cutlass::int4b_t, LayoutB_=cutlass::layout::ColumnMajor, TransformB=cutlass::ComplexTransform::kNone, kAlignmentB=32, ElementC_=cutlass::half_t, LayoutC_=cutlass::layout::RowMajor, kAlignmentC=8, ElementAccumulator=int32_t, ElementEpilogue=float, OperatorClass=cutlass::arch::OpClassTensorOp, ArchTag=cutlass::arch::Sm80, ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, FusionCallbacks=cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorAuxStore<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cutlass::FloatRoundStyle::round_to_nearest, cute::tuple<int64_t, cute::C<1>, int64_t>>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::plus, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::TreeVisitor2x<cutlass::epilogue::threadblock::VisitorCompute<cutlass::multiplies, float, float, cutlass::FloatRoundStyle::round_to_nearest, void>, cutlass::epilogue::threadblock::VisitorAccFetch, cutlass::epilogue::threadblock::VisitorColBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_1, cute::_0, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorRowBroadcast<cutlass::epilogue::threadblock::OutputTileThreadLayout<cutlass::gemm::GemmShape<32, 128, 128>, cutlass::gemm::GemmShape<32, 32, 128>, cutlass::half_t, 8, 1>, cutlass::half_t, cute::tuple<cute::_0, cute::_1, int64_t>, true>>, cutlass::epilogue::threadblock::VisitorScalarBroadcast<cutlass::half_t, cute::tuple<cute::C<0>, cute::_0, cute::C<0>>, 1, cutlass::multiplies>>>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, Stages=5, Operator=cutlass::arch::OpMultiplyAddMixedInputUpcast, EpilogueStages=1]" at line 396 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::rowwise_scaled_linear_kernel_cutlass_sm8x_unified<ThreadblockShape,WarpShape,InstructionShape,ThreadblockSwizzle,NumStages,ElementA,ElementB,ElementOutput,ElementC,UseTensorC,ElementAScale,ElementBScale>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ThreadblockShape=cutlass::gemm::GemmShape<32, 128, 128>, WarpShape=cutlass::gemm::GemmShape<32, 32, 128>, InstructionShape=cutlass::gemm::GemmShape<16, 8, 32>, ThreadblockSwizzle=cutlass::gemm::threadblock::ThreadblockSwizzleStreamK, NumStages=5, ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, ElementC=cutlass::half_t, UseTensorC=std::false_type, ElementAScale=cutlass::half_t, ElementBScale=cutlass::half_t]" at line 589 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::select_config_unified<ElementA,ElementB,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, Types=<cutlass::half_t, cutlass::half_t, std::false_type, cutlass::half_t, cutlass::half_t>]" at line 640 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_c_unified<ElementA,ElementB,ElementOutput,Types...>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t, ElementOutput=cutlass::half_t, Types=<cutlass::half_t, cutlass::half_t>]" at line 678 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "void torchao::dispatch_on_tensor_a_scale_and_tensor_b_scale_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 837 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_unified.cuh
                instantiation of "at::Tensor torchao::rowwise_scaled_linear_cutlass_unified<ElementA,ElementB>(const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, const at::Tensor &, at::Tensor &) [with ElementA=cutlass::half_t, ElementB=cutlass::int4b_t]" at line 50 of /workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu
    
    Error limit reached.
    100 errors detected in the compilation of "/workspace/qspec/ao/torchao/csrc/cuda/rowwise_scaled_linear_cutlass/rowwise_scaled_linear_cutlass_s4s4.cu".
    Compilation terminated.
    ninja: build stopped: subcommand failed.
    Traceback (most recent call last):
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2104, in _run_ninja_build
        subprocess.run(
      File "/opt/conda/envs/QServe/lib/python3.10/subprocess.py", line 526, in run
        raise CalledProcessError(retcode, process.args,
    subprocess.CalledProcessError: Command '['ninja', '-v']' returned non-zero exit status 1.
    
    The above exception was the direct cause of the following exception:
    
    Traceback (most recent call last):
      File "<string>", line 2, in <module>
      File "<pip-setuptools-caller>", line 34, in <module>
      File "/workspace/qspec/ao/setup.py", line 305, in <module>
        setup(
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/__init__.py", line 117, in setup
        return distutils.core.setup(**attrs)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/core.py", line 186, in setup
        return run_commands(dist)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/core.py", line 202, in run_commands
        dist.run_commands()
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/dist.py", line 983, in run_commands
        self.run_command(cmd)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/dist.py", line 999, in run_command
        super().run_command(command)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/dist.py", line 1002, in run_command
        cmd_obj.run()
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/develop.py", line 35, in run
        self.install_for_development()
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/develop.py", line 112, in install_for_development
        self.run_command('build_ext')
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/cmd.py", line 339, in run_command
        self.distribution.run_command(command)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/dist.py", line 999, in run_command
        super().run_command(command)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/dist.py", line 1002, in run_command
        cmd_obj.run()
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 99, in run
        _build_ext.run(self)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 365, in run
        self.build_extensions()
      File "/workspace/qspec/ao/setup.py", line 161, in build_extensions
        super().build_extensions()
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 868, in build_extensions
        build_ext.build_extensions(self)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 481, in build_extensions
        self._build_extensions_serial()
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 507, in _build_extensions_serial
        self.build_extension(ext)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 264, in build_extension
        _build_ext.build_extension(self, ext)
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/setuptools/_distutils/command/build_ext.py", line 562, in build_extension
        objects = self.compiler.compile(
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 681, in unix_wrap_ninja_compile
        _write_ninja_file_and_compile_objects(
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1784, in _write_ninja_file_and_compile_objects
        _run_ninja_build(
      File "/opt/conda/envs/QServe/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2120, in _run_ninja_build
        raise RuntimeError(message) from e
    RuntimeError: Error compiling objects for extension
    [end of output]

note: This error originates from a subprocess, and is likely not a problem with pip.
